<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>G Studio Analytics</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container { max-width: 1400px; margin: 0 auto; }
    header {
      background: white;
      padding: 30px;
      border-radius: 12px;
      margin-bottom: 30px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    }
    h1 { color: #333; margin-bottom: 10px; font-size: 32px; }
    .subtitle { color: #666; font-size: 14px; }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .card {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    }
    .card h2 {
      color: #333;
      margin-bottom: 20px;
      font-size: 18px;
      border-bottom: 2px solid #667eea;
      padding-bottom: 10px;
    }
    .platform-block {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid #eee;
    }
    .platform-block:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    .platform-name {
      font-weight: 700;
      color: #667eea;
      margin-bottom: 12px;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .input-group {
      margin-bottom: 12px;
    }
    .input-group label {
      display: block;
      font-size: 12px;
      color: #666;
      margin-bottom: 4px;
      font-weight: 600;
    }
    .input-group input {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 13px;
    }
    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      width: 100%;
      margin-top: 15px;
    }
    button:hover { background: #5568d3; }
    .metric-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 13px;
    }
    .metric-label { color: #666; }
    .metric-value { font-weight: 600; color: #333; }
    .update-time {
      text-align: center;
      color: rgba(255,255,255,0.8);
      margin-top: 20px;
      font-size: 12px;
    }
    .loading { color: #999; padding: 20px; text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üéµ G Studio Analytics</h1>
      <p class="subtitle">Real-time social media metrics</p>
    </header>

    <div class="grid">
      <!-- Personal Account -->
      <div class="card">
        <h2>üë§ Georgiy Yukhanov</h2>
        
        <div class="platform-block">
          <div class="platform-name">Instagram (@dmcstyle)</div>
          <div class="input-group">
            <label>Views</label>
            <input type="number" id="ig-personal-views" placeholder="0">
          </div>
          <div class="input-group">
            <label>Likes</label>
            <input type="number" id="ig-personal-likes" placeholder="0">
          </div>
          <div class="input-group">
            <label>Shares</label>
            <input type="number" id="ig-personal-shares" placeholder="0">
          </div>
        </div>

        <div class="platform-block">
          <div class="platform-name">YouTube (@georgeyukhanov)</div>
          <div class="input-group">
            <label>Views</label>
            <input type="number" id="yt-personal-views" placeholder="0">
          </div>
          <div class="input-group">
            <label>Likes</label>
            <input type="number" id="yt-personal-likes" placeholder="0">
          </div>
          <div class="input-group">
            <label>Shares</label>
            <input type="number" id="yt-personal-shares" placeholder="0">
          </div>
        </div>

        <button onclick="savePersonal()">Save Personal Metrics</button>
        <div id="personal-display"></div>
      </div>

      <!-- Studio Account -->
      <div class="card">
        <h2>üéµ G Studio (@dubaimusicstudio)</h2>
        
        <div class="platform-block">
          <div class="platform-name">Instagram</div>
          <div class="input-group"><label>Views</label><input type="number" id="ig-studio-views" placeholder="0"></div>
          <div class="input-group"><label>Likes</label><input type="number" id="ig-studio-likes" placeholder="0"></div>
          <div class="input-group"><label>Shares</label><input type="number" id="ig-studio-shares" placeholder="0"></div>
        </div>

        <div class="platform-block">
          <div class="platform-name">TikTok</div>
          <div class="input-group"><label>Views</label><input type="number" id="tt-studio-views" placeholder="0"></div>
          <div class="input-group"><label>Likes</label><input type="number" id="tt-studio-likes" placeholder="0"></div>
          <div class="input-group"><label>Shares</label><input type="number" id="tt-studio-shares" placeholder="0"></div>
        </div>

        <div class="platform-block">
          <div class="platform-name">YouTube</div>
          <div class="input-group"><label>Views</label><input type="number" id="yt-studio-views" placeholder="0"></div>
          <div class="input-group"><label>Likes</label><input type="number" id="yt-studio-likes" placeholder="0"></div>
          <div class="input-group"><label>Shares</label><input type="number" id="yt-studio-shares" placeholder="0"></div>
        </div>

        <div class="platform-block">
          <div class="platform-name">X (@gstudiodubai)</div>
          <div class="input-group"><label>Views</label><input type="number" id="x-studio-views" placeholder="0"></div>
          <div class="input-group"><label>Likes</label><input type="number" id="x-studio-likes" placeholder="0"></div>
        </div>

        <div class="platform-block">
          <div class="platform-name">Threads</div>
          <div class="input-group"><label>Views</label><input type="number" id="threads-studio-views" placeholder="0"></div>
          <div class="input-group"><label>Likes</label><input type="number" id="threads-studio-likes" placeholder="0"></div>
        </div>

        <button onclick="saveStudio()">Save Studio Metrics</button>
        <div id="studio-display"></div>
      </div>
    </div>

    <div class="update-time">
      Last updated: <span id="timestamp">--:-- GMT+4</span>
    </div>
  </div>

  <script>
    // API URL - will be replaced when deployed to cloud
    const API_BASE = window.location.hostname === 'localhost' 
      ? 'http://localhost:3001/api/metrics'
      : 'https://gstudio-metrics-api.onrender.com/api/metrics';

    async function loadMetrics() {
      try {
        const res = await fetch(API_BASE);
        const data = await res.json();
        populateForm(data);
        displayMetrics(data);
      } catch (e) {
        console.error('Load error:', e);
        document.getElementById('personal-display').innerHTML = '<div class="loading">‚ö†Ô∏è API not available. Using local storage.</div>';
      }
    }

    function populateForm(data) {
      if (data.personal?.instagram) {
        document.getElementById('ig-personal-views').value = data.personal.instagram.views || 0;
        document.getElementById('ig-personal-likes').value = data.personal.instagram.likes || 0;
        document.getElementById('ig-personal-shares').value = data.personal.instagram.shares || 0;
      }
      if (data.personal?.youtube) {
        document.getElementById('yt-personal-views').value = data.personal.youtube.views || 0;
        document.getElementById('yt-personal-likes').value = data.personal.youtube.likes || 0;
        document.getElementById('yt-personal-shares').value = data.personal.youtube.shares || 0;
      }
      if (data.studio?.instagram) {
        document.getElementById('ig-studio-views').value = data.studio.instagram.views || 0;
        document.getElementById('ig-studio-likes').value = data.studio.instagram.likes || 0;
        document.getElementById('ig-studio-shares').value = data.studio.instagram.shares || 0;
      }
      if (data.studio?.tiktok) {
        document.getElementById('tt-studio-views').value = data.studio.tiktok.views || 0;
        document.getElementById('tt-studio-likes').value = data.studio.tiktok.likes || 0;
        document.getElementById('tt-studio-shares').value = data.studio.tiktok.shares || 0;
      }
      if (data.studio?.youtube) {
        document.getElementById('yt-studio-views').value = data.studio.youtube.views || 0;
        document.getElementById('yt-studio-likes').value = data.studio.youtube.likes || 0;
        document.getElementById('yt-studio-shares').value = data.studio.youtube.shares || 0;
      }
      if (data.studio?.x) {
        document.getElementById('x-studio-views').value = data.studio.x.views || 0;
        document.getElementById('x-studio-likes').value = data.studio.x.likes || 0;
      }
      if (data.studio?.threads) {
        document.getElementById('threads-studio-views').value = data.studio.threads.views || 0;
        document.getElementById('threads-studio-likes').value = data.studio.threads.likes || 0;
      }
    }

    function displayMetrics(data) {
      updateTimestamp(data.lastUpdated);
    }

    async function savePersonal() {
      const updates = [
        fetch(`${API_BASE}/personal/instagram`, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({
            views: document.getElementById('ig-personal-views').value || 0,
            likes: document.getElementById('ig-personal-likes').value || 0,
            shares: document.getElementById('ig-personal-shares').value || 0
          })
        }),
        fetch(`${API_BASE}/personal/youtube`, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({
            views: document.getElementById('yt-personal-views').value || 0,
            likes: document.getElementById('yt-personal-likes').value || 0,
            shares: document.getElementById('yt-personal-shares').value || 0
          })
        })
      ];
      
      try {
        await Promise.all(updates);
        loadMetrics();
        alert('‚úÖ Personal metrics saved!');
      } catch (e) {
        alert('‚ùå Error: ' + e.message);
      }
    }

    async function saveStudio() {
      const updates = [
        fetch(`${API_BASE}/studio/instagram`, {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({views: document.getElementById('ig-studio-views').value || 0, likes: document.getElementById('ig-studio-likes').value || 0, shares: document.getElementById('ig-studio-shares').value || 0})}),
        fetch(`${API_BASE}/studio/tiktok`, {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({views: document.getElementById('tt-studio-views').value || 0, likes: document.getElementById('tt-studio-likes').value || 0, shares: document.getElementById('tt-studio-shares').value || 0})}),
        fetch(`${API_BASE}/studio/youtube`, {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({views: document.getElementById('yt-studio-views').value || 0, likes: document.getElementById('yt-studio-likes').value || 0, shares: document.getElementById('yt-studio-shares').value || 0})}),
        fetch(`${API_BASE}/studio/x`, {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({views: document.getElementById('x-studio-views').value || 0, likes: document.getElementById('x-studio-likes').value || 0})}),
        fetch(`${API_BASE}/studio/threads`, {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({views: document.getElementById('threads-studio-views').value || 0, likes: document.getElementById('threads-studio-likes').value || 0})})
      ];
      
      try {
        await Promise.all(updates);
        loadMetrics();
        alert('‚úÖ Studio metrics saved!');
      } catch (e) {
        alert('‚ùå Error: ' + e.message);
      }
    }

    function updateTimestamp(timestamp) {
      const date = new Date(timestamp);
      document.getElementById('timestamp').textContent = date.toLocaleString('en-GB', {timeZone: 'Asia/Dubai'});
    }

    window.addEventListener('load', loadMetrics);
    setInterval(loadMetrics, 30000); // Refresh every 30 seconds
  </script>
</body>
</html>
